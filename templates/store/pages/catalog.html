{% extends 'layout.html' %}
{% import 'macros/utils.jinja' as util %}

{% block title %}{{ page.title }} — {{ site.title }}{% endblock %}

{% block content %}
<section class="section">
  <header class="section-header">
    <h1>{{ page.heading }}</h1>
    <p>{{ page.description }}</p>
  </header>

  {%- set filters_data = filters | default({}, true) -%}
  {% if filters_data and filters_data.groups is defined and filters_data.groups %}
  <div class="filters">
    {% for group in filters_data.groups %}
    <article class="filter-card">
      <h3>{{ group.title }}</h3>
      <ul>
        {% for option in group.options %}
        <li>
          <a href="{{ util.tenant_href('catalog') }}?{{ option.query }}">
            {{ option.label }}
          </a>
          {% if option.count is defined %}
          <span class="filter-count">{{ option.count }}</span>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
    </article>
    {% endfor %}
  </div>
  {% endif %}

  <div id="catalog-results" class="product-grid">
    <p class="product-grid__empty">Loading catalog…</p>
  </div>
</section>
<script
  type="module"
  src="/static/catalog-search-app.js"
  data-module="catalog-search"
  data-view="catalog"
  data-site-slug="{{ site.slug }}"
  data-results-target="#catalog-results"
  data-catalog-url="{{ catalog_url | default('/static/catalog.bin', true) }}"
></script>
{% endblock %}
